@model List<Person>;

@{
    ViewData["Title"] = "Get All";
}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
    <a class="btn btn-primary" asp-action="CreateNewMember">Create New Member</a>
    <table class="table table-striped">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">First Name</th>
      <th scope="col">Last Name</th>
      <th scope="col">Gender</th>
      <th scope="col">Date of Birth</th>
      <th scope="col">Phone Number</th>
      <th scope="col">Birth Place</th>
      <th scope="col">Age</th>
      <th scope="col">FullName</th>
      <th scope="col">Options</th>
    </tr>
  </thead>
  <tbody>
    @for (var i = 0; i < Model.Count; i++)
    {
        var person = Model[i];
        <tr>
            <th scope="row">@(person.Id)</th>
            <td>@person.FirstName</td>
            <td>@person.LastName</td>
            <td>@person.Gender</td>
            <td>@person.DateOfBirth.ToString()</td>
            <td>@person.PhoneNumber</td>
            <td>@person.BirthPlace</td>
            <td>@person.Age</td>
            <td>
              <a class="btn-lg" asp-action="GetDetails" asp-route-id="@(person.Id)">@person.FullName</a>
            </td>
            <td>
                <a class="btn btn-primary" asp-action="EditInfoMember" asp-route-id="@(person.Id)">Edit</a>
                <a class="btn btn-primary" asp-action="DeleteMember" asp-route-id="@(person.Id)">Delete</a>
                <button type="button" class="btn btn-danger btnDelete" data-bs-toggle="modal" data-bs-target="#exampleModal" value="@(person.Id)">
                  Delete
                </button>
            </td>
        </tr>
    }
  </tbody>
</table>
</div>


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Cảnh báo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Xác nhận xóa người dùng này
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-danger btnDeleteSubmit">Delete</button>
      </div>
    </div>
  </div>
</div>

<script>
  const deleteButtons = document.querySelectorAll(".btnDelete");
  const deleteButtonSubmit = document.querySelector(".btnDeleteSubmit");
  deleteButtons.forEach(button => {
    button.addEventListener('click', () => {
      const personId = button.value;
      deleteButtonSubmit.addEventListener('click', () => {
        fetch(`https://localhost:7076/elite/delete-member/?id=${personId}`);
        location.reload();
      })
    });
  })
</script>